<html>
<head>
<link rel="stylesheet" href="https://cdn.datatables.net/1.12.0/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/fixedheader/3.2.3/css/fixedHeader.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/fixedcolumns/4.1.0/css/fixedColumns.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/searchpanes/2.0.1/css/searchPanes.dataTables.min.css">
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.12.0/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/fixedheader/3.2.3/js/dataTables.fixedHeader.min.js"></script>
<script src="https://cdn.datatables.net/fixedcolumns/4.1.0/js/dataTables.fixedColumns.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.colVis.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.print.min.js"></script>
<script src="https://cdn.datatables.net/select/1.4.0/js/dataTables.select.min.js"></script>
<script src="https://cdn.datatables.net/searchpanes/2.0.1/js/dataTables.searchPanes.min.js"></script>
</head>
<body>
<table id="tableArray" class="display" style="width:100%"></table>
<script>
$(document).ready( function () {
var table = $('#tableArray').DataTable({
	ajax: "equipments.txt",
        "columns": [
          { title: "name" },
          { title: "type" },
          { title: "level" },
          { title: "rarity" },
          { title: "ap" },
          { title: "mp" },
          { title: "wp" },
          { title: "range" },
          { title: "control" },
          { title: "hp" },
          { title: "lock" },
          { title: "dodge" },
          { title: "ini" },
          { title: "cri" },
          { title: "block" },
          { title: "elr" },
          { title: "ag" },
          { title: "ar" },
          { title: "elm_n" },
          { title: "elm" },
          { title: "crim" },
          { title: "st" },
          { title: "aoe" },
          { title: "dis" },
          { title: "mel" },
          { title: "ber" },
          { title: "rear" },
          { title: "heal" },
          { title: "crir" },
          { title: "rr" },
          { title: "pro" },
          { title: "wis" },
          { title: "ks" },
        ],
fixedHeader: true,
fixedColumns: true,
"order": [[1, "desc"], [2, "desc"], [19, "desc"], [15, "desc"]],
dom: 'BPlfrtip',
columnDefs:[
	{targets: [0, 1, 2, 3], className: 'noVis'},
	{"orderSequence": ["desc", "asc"], targets:"_all"},
	{searchPanes: {show: false}, targets: [0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]},
	{"visible": false, "targets": [3, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13]}
],
        buttons: ['copy',{
                extend: 'colvis',
                collectionLayout: 'fixed columns',
		columns: ':not(.noVis)'
            }],
        select: true,
    processing: true,
  rowCallback: function( row, data ) {
    if ( data[3] == "金" ) {
      $('td:eq(0)', row).css({"background-color": "#F9E79F"});}
    else if ( data[3] == "橘" ) {
      $('td:eq(0)', row).css({"background-color": "#E59866"});}
    else if ( data[3] == "綠" ) {
      $('td:eq(0)', row).css({"background-color": "#ABEBC6"});}
    else if ( data[3] == "粉" ) {
      $('td:eq(0)', row).css({"background-color": "#F2D7D5"});}
    else if ( data[3] == "紫" ) {
      $('td:eq(0)', row).css({"background-color": "#D7BDE2"});}
    else if ( data[3] == "藍" ) {
      $('td:eq(0)', row).css({"background-color": "#AED6F1"});}
  }
    });
});
</script>
</body>
</html>